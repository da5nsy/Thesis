\chapter{Computational Study}
\label{ComputationalStudyChapter}

\epigraph{You don't really understand what you've got until you do a comprehensive model of it.}
{\textit{Christopher Tyler} \\ (Q\&A session at VSS 2019)}

\textit{The work presented here has been presented previously as a poster presentation at VSS 2018 \citep{garside_does_2018}\footnote{Poster available: \doi{10.6084/m9.figshare.6280865.v1}} and as an oral presentation at ICVS 2019 \footnote{Slides and abstract available: \doi{10.6084/m9.figshare.8832395.v1}}}.

\section{Summary}

% I am interested in the question of whether a melanopic signal might be useful for either estimating the illuminant(s) in a scene, or more directly transforming visual signals into an illuminant-independent space.

% Following initial psychophysical experiments, where results did not indicate a strong or simple relationship, I chose to take a step back and examine the problem that the HVS is faced with in a natural environment, which colour constancy solves. Through this route I hoped to answer the questions:
% \begin{enumerate}
% 	\item Would it be sensible for the HVS to use a melanopic signal to help solve this problem?
% 	\item If so, in what way would it be used?
% \end{enumerate}

Code is provided: \url{https://github.com/da5nsy/Melanopsin_Computational}

\section{Introduction}

In the other chapters of this thesis the approach taken to study the effect of melanopsin has mirrored standard practice: we think that melanopsin \emph{might} be involved in a specific process (for reasons that seem sensible enough) and so we run an experiment where we vary the amount of melanopsin activation within a stimuli and measure something to see if there is an associated change with the hope of understanding \emph{how} melanopsin might be involved, but at no point do we really drill down on the questions of \emph{why} melanopsin might be involved.

This has meant that it is unclear whether our results (positive or negative) can be taken at face value - perhaps our assumptions about what the benefits of a melanopsin-based signal were wrong, and we were consequently looking in the wrong place.

This chapter shall describe an exploratory computational study which took an ecological modelling approach to try and further our understanding of what, if any, benefits may arise by the use of a melanopsin-based signal for colour constancy.

\noindent The proposed benefits of this approach are: 
\begin{enumerate}
    \item It may be possible to answer the question of whether it is sensible in any way for melanopsin to be involved in colour constancy in any form whatsoever - is there any benefit to be had from involving melanopsin?
    \item We may be able to suggest or rule out specific computational structures - one computation might be beneficial whilst others might not be.
    \item It may be able to narrow the search area for future psychophysical experimentation - in previous experiments there have been lots of assumptions about the luminance range that melanopsin is active over, the spatial distribution (both in terms of receptive fields and influence over signals from distant parts of the retina), the temporal dynamics of the signals involved (and many other assumptions but conscious and unconscious). This is an opportunity to test whether a melanopsin-based signal is useful for specific ranges of the stimulus space over others, with the assumption that an interaction is more likely to exist in a manner which is advantageous to the host.
\end{enumerate}

\noindent The key research question for this section can be posed such:

\begin{quote}
Considering the conditions on our planet, \\
and the ecological requirements of vision, \\
would a signal from a melanopsin-expressing cell \\
be useful for colour constancy?
\end{quote}

This chapter shall give an overview of the main scripts which have been written, going through the logic and results of each. By doing this, a roughly chronological path of the thought processes involved will be presented.

\input{melcomp1}
\input{melcomp2}
\input{melcomp3}

\section{melcomp\_4 and 5}
These two short scripts are minor tests which are not worth going into.

\section{melcomp\_6}
This script produced figures for a presentation to Hannah Smithson's group in Oxford, which was predominantly based upon the logic of melcomp\_1 and 2. The key figure was a presentation of how a set of clusters could be drawn together into a rough illuminant-independent space, such as is shown in Figure \ref{fig:corrected}.

It also introduced a measure of non-planarity, calculated by performing a principal components analysis on the cloud of points $[l,s,i]_{\text{MB}}$, and looking at how much variance was unaccounted for by the first two principal components. It was found that there were two parts of the spectrum where an effective corrective signal (in terms of non-planarity); firstly at around and just higher than the peak spectral sensitivity of melanopsin, and secondly with a melanopsin shift of about positive 75nm (see `Standard' in Figure \ref{fig:PC3}). It was found that minor changes in parameters used to make these calculations, such as surface set used or observer used, could have moderate effects on the optimal sensitivity for a sensor whose task was to provide a signal for transforming cone signals (see others in Figure \ref{fig:PC3}).

\begin{figure}[htbp]
    \includegraphics[max width=\textwidth]{figs/comp/melcomp_6/PC3.pdf}
    \caption{}
    \label{fig:PC3}
\end{figure} 

One final element introduced here was the explicit comparison to other colour constancy algorithms, though discussion of this shall be saved for a later section.

\section{melcomp\_7 and 8}
Melcomp 7 is very minor.
Melcomp 8 is an exploration into how to measure the effectiveness of a colour constancy algorithm (before K-means is introduced in melcomp\_9).

\input{melcomp9}

\section{Further work}

\begin{itemize}
\item Further investigate \emph{why} a melanopic transform might work
\begin{itemize}
\item Surface spectral regularities?
\item Test with artificial surfaces and illuminants
\end{itemize}
\item Work out how much of the optimality function is noise
\begin{itemize}
\item Re-run test with random number generators un-set or set with different seeds to understand their influence
\item Consider different observers, daylight data and surface data
\end{itemize}
\item Simplify the grading mechanism (K-means is over the top)
\item Try more complex melanopsin-based transforms
\item Compare and combine with other colour constancy algorithms
\item Don't keep it limited to colorimetry, consider luminance/PC1 also (e.g. \citet{chakrabarti_color_2015}). 
\item Would such a system explain the unexpected results of \citet{cao_evidence_2018}? (LM modulation but not S)
\item If we do use this signal in natural environments, does the degradation of this signal in artificial environments impact our preference ratings? Could evidence of this mechanism show up in lighting preference indices used in the lighting engineering world?
\end{itemize}




% I've got figs but I'd need to reprocess them.


%\begin{figure}
%     \centering
%     \begin{subfigure}[b]{0.49\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{figs/mb.pdf}
%         \caption{$y=x$}
%         \label{fig:y equals x}
%     \end{subfigure}
%     \hfill
%     \begin{subfigure}[b]{0.49\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{figs/corrected.pdf}
%         \caption{$y=3sinx$}
%         \label{fig:three sin x}
%     \end{subfigure}
%     \hfill
%        \caption{Three simple graphs}
%        \label{fig:three graphs}
%\end{figure}

